<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width,initial-scale=1"><title>ESP32 Management AP</title><style>body{width:fit-content}tr:hover{background-color:#add8e6;cursor:pointer}tr.selected{background-color:#87cefa}.centered{text-align:center}div.container{max-width:500px;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.lds-dual-ring{display:inline-block;width:60px;height:60px}.lds-dual-ring:after{content:" ";display:block;width:40px;height:40px;margin:8px;border-radius:50%;border:6px solid #fff;border-color:#000 transparent;animation:lds-dual-ring 1.5s linear infinite}@keyframes lds-dual-ring{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}body,input,select,textarea{background:0;border-radius:0;font:16px sans-serif;margin:0}.smooth{transition:all .2s}.btn,.nav a{text-decoration:none}.container{margin:0 20px;width:auto}label>*{display:inline}form>*{display:block;margin-bottom:10px}.btn{background:#999;border-radius:6px;border:0;color:#fff;cursor:pointer;display:inline-block;margin:2px 0;padding:12px 30px 14px}.btn:hover{background:#888}.btn:active,.btn:focus{background:#777}.btn-a{background:#0ae}.btn-a:hover{background:#09d}.btn-a:active,.btn-a:focus{background:#08b}.btn-b{background:#3c5}.btn-b:hover{background:#2b4}.btn-b:active,.btn-b:focus{background:#2a4}.btn-c{background:#d33}.btn-c:hover{background:#c22}.btn-c:active,.btn-c:focus{background:#b22}.btn-sm{border-radius:4px;padding:10px 14px 11px}.row{margin:1% 0;overflow:auto}.col{float:left}.c12,.table{width:100%}.c11{width:91.66%}.c10{width:83.33%}.c9{width:75%}.c8{width:66.66%}.c7{width:58.33%}.c6{width:50%}.c5{width:41.66%}.c4{width:33.33%}.c3{width:25%}.c2{width:16.66%}.c1{width:8.33%}h1{font-size:3em}.btn,h2{font-size:2em}.ico{font:33px Arial Unicode MS,Lucida Sans Unicode}.addon,.btn-sm,.nav,input,select,textarea{outline:0;font-size:14px}input,select,textarea{padding:8px;border:1px solid #ccc}input:focus,select:focus,textarea:focus{border-color:#5ab}input[type=text],textarea{-webkit-appearance:none;width:13em}.addon{padding:8px 12px;box-shadow:0 0 0 1px #ccc}.nav,.nav .current,.nav a:hover{background:#000;color:#fff}.nav{height:24px;padding:11px 0 15px}.nav a{color:#aaa;padding-right:1em;position:relative;top:-1px}.nav .pagename{font-size:22px;top:1px}.btn.btn-close{background:#000;float:right;font-size:25px;margin:-54px 7px;display:none}@media(min-width:1310px){.container{margin:auto;width:1270px}}@media(max-width:870px){.row .col{width:100%}}@media(max-width:500px){.btn.btn-close{display:block}.nav{overflow:hidden}.pagename{margin-top:-11px}.nav:active,.nav:focus{height:auto}.nav div:before{background:#000;border-bottom:10px double;border-top:3px solid;content:'';float:right;height:4px;position:relative;right:3px;top:14px;width:20px}.nav a{padding:.5em 0;display:block;width:50%}}.table td,.table th{padding:.5em;text-align:left}.table tbody>:nth-child(2n-1){background:#ddd}.msg{padding:1.5em;background:#def;border-left:5px solid #59d}</style></head><body onload="getStatus()"><div class="container"><h2 class="centered">ESP32 Wi-Fi Pentest</h2><div class="msg warning" id="errors"></div><section id="loading" class="centered"><div class="lds-dual-ring centered"></div></section><section id="ready" style="display: none;"><form onsubmit="runAttack(); return false;"><fieldset><legend>Select Target</legend><table id="ap-list" class="table"></table><p><button type="button" onclick="refreshAps()" class="btn btn-a btn-sm smooth">Scan</button></p></fieldset><fieldset><legend>Attack Configuration</legend><p><label for="attack_type">Type:</label> <select id="attack_type" onchange="updateConfigurableFields(this)" required=""><option value="0" title="This type is not implemented yet." disabled="disabled">ATTACK_TYPE_PASSIVE</option><option value="1">ATTACK_TYPE_HANDSHAKE</option><option value="2" selected="selected">ATTACK_TYPE_PMKID</option><option value="3">ATTACK_TYPE_DOS</option></select></p><p><label for="attack_method">Method:</label> <select id="attack_method" required="" disabled="disabled"><option value="" selected="selected" disabled="disabled" hidden="">NOT AVAILABLE</option></select></p><p><label for="attack_timeout">Timeout (seconds):</label> <input type="number" min="0" max="255" id="attack_timeout" value="" required=""></p><p><button class="btn btn-c btn-sm smooth">Attack</button></p></fieldset></form></section><section id="running" style="display: none;">Time elapsed: <span id="running-progress"></span></section><section id="result" style="display: none;"><div id="result-meta">Loading result.. Please wait</div><div id="result-content"></div><button type="button" onclick="resetAttack()">New attack</button></section></div><script>var poll,running_poll,AttackStateEnum={READY:0,RUNNING:1,FINISHED:2,TIMEOUT:3},AttackTypeEnum={ATTACK_TYPE_PASSIVE:0,ATTACK_TYPE_HANDSHAKE:1,ATTACK_TYPE_PMKID:2,ATTACK_TYPE_DOS:3},selectedApElement=-1,poll_interval=1e3,running_poll_interval=1e3,attack_timeout=0,time_elapsed=0,defaultResultContent=$("result").innerHTML,defaultAttackMethods=$("attack_method").outerHTML;function $(t){return document.getElementById(t)}function showError(t){$("errors").innerText=t,$("errors").style.display="block"}function hideError(){$("errors").style.display="none"}function getStatus(){hideError();var a=new XMLHttpRequest;a.onload=function(){var t=a.response;if(t){var e=parseInt(new Uint8Array(t,0,1)),n=parseInt(new Uint8Array(t,1,1)),r=parseInt(new Uint16Array(t,2,1)),o=new Uint8Array(t,4);switch(console.log("attack_state="+e+"; attack_type="+n+"; attack_count_size="+r),hideAllSections(),e){case AttackStateEnum.READY:showAttackConfig();break;case AttackStateEnum.RUNNING:showRunning(),console.log("Poll"),setTimeout(getStatus,poll_interval);break;case AttackStateEnum.FINISHED:showResult("FINISHED",n,r,o);break;case AttackStateEnum.TIMEOUT:showResult("TIMEOUT",n,r,o);break;default:$("errors").innerHTML="Error loading attack status! Unknown state."}}},a.onerror=function(){showError("Cannot reach ESP32. Check that you are connected to management AP. You might get disconnected during attack."),getStatus()},a.ontimeout=function(){console.log("Request timeout"),getStatus()},a.open("GET","http://192.168.4.1/status",!0),a.responseType="arraybuffer",a.send()}function hideAllSections(){for(var t of document.getElementsByTagName("section"))t.style.display="none"}function showRunning(){hideAllSections(),$("running").style.display="block"}function countProgress(){attack_timeout<=time_elapsed&&($("errors").innerHTML="Please reconnect to management AP",$("errors").style.display="block",clearInterval(running_poll)),$("running-progress").innerHTML=time_elapsed+"/"+attack_timeout+"s",time_elapsed++}function showAttackConfig(){$("ready").style.display="block",refreshAps()}function showResult(t,e,n,r){switch(hideAllSections(),clearInterval(poll),$("result").innerHTML=defaultResultContent,$("result").style.display="block",$("result-meta").innerHTML=t+"<br>",type="ERROR: Cannot parse attack type.",e){case AttackTypeEnum.ATTACK_TYPE_PASSIVE:type="ATTACK_TYPE_PASSIVE";break;case AttackTypeEnum.ATTACK_TYPE_HANDSHAKE:type="ATTACK_TYPE_HANDSHAKE",resultHandshake(r,n);break;case AttackTypeEnum.ATTACK_TYPE_PMKID:type="ATTACK_TYPE_PMKID",resultPmkid(r,n);break;case AttackTypeEnum.ATTACK_TYPE_DOS:type="ATTACK_TYPE_DOS";break;default:type="UNKNOWN"}$("result-meta").innerHTML+=type+"<br>"}function generateRow(t,e,n,r){return tr=document.createElement("tr"),tr.setAttribute("id",t),tr.setAttribute("onClick","selectAp(this)"),tr.innerHTML=`<td>${e}</td><td>${n}</td><td>${r}</td>`,tr}function refreshAps(){hideError();let o=$("ap-list");o.innerHTML="Loading (this may take a while)...";var e=new XMLHttpRequest;e.onload=function(){o.innerHTML="<th>SSID</th><th>BSSID</th><th>RSSI</th>";var t=e.response;if(t){var n=new Uint8Array(t);for(let e=0;e<n.byteLength;e+=40){var r=[];for(let t=0;t<6;t++)r.push(uint8ToHex(n[e+33+t]));o.appendChild(generateRow(e/40,new TextDecoder("utf-8").decode(n.subarray(e+0,e+32)),r.join(":"),n[e+39]-255))}}},e.onerror=function(){o.innerHTML="ERROR",showError("Unable to load AP list")},e.open("GET","http://192.168.4.1/ap-list",!0),e.responseType="arraybuffer",e.send()}function selectAp(t){console.log(t.id),-1!=selectedApElement&&selectedApElement.classList.remove("selected"),(selectedApElement=t).classList.add("selected")}function runAttack(){if(-1==selectedApElement)return console.log("No AP selected. Attack not started."),void($("errors").innerHTML="No AP selected. Attack not started.");hideAllSections(),$("running").style.display="block";var t=new ArrayBuffer(4),e=new Uint8Array(t);e[0]=parseInt(selectedApElement.id),e[1]=parseInt($("attack_type").value),e[2]=parseInt($("attack_method").value),e[3]=parseInt($("attack_timeout").value);e=new XMLHttpRequest;e.open("POST","http://192.168.4.1/run-attack",!0),e.send(t),getStatus(),attack_timeout=parseInt($("attack_timeout").value),time_elapsed=0,running_poll=setInterval(countProgress,running_poll_interval)}function resetAttack(){hideAllSections(),showAttackConfig();var t=new XMLHttpRequest;t.open("HEAD","http://192.168.4.1/reset",!0),t.send()}function resultPmkid(e,n){var r="",o="",a="",s="",c="",l=0;for(let t=0;t<6;t+=1)r+=uint8ToHex(e[l+t]);l+=6;for(let t=0;t<6;t+=1)o+=uint8ToHex(e[l+t]);l+=6;for(let t=0;t<e[l];t+=1)a+=uint8ToHex(e[l+1+t]),s+=String.fromCharCode(e[l+1+t]);var l=l+e[l]+1,i=0;for(let t=0;t<n-l;t+=1)t%16==0&&(c+="<br>",c+="</code>PMKID #"+i+": <code>",i+=1),c+=uint8ToHex(e[l+t]);$("result-content").innerHTML="",$("result-content").innerHTML+="MAC AP: <code>"+r+"</code><br>",$("result-content").innerHTML+="MAC STA: <code>"+o+"</code><br>",$("result-content").innerHTML+="(E)SSID: <code>"+a+"</code> ("+s+")",$("result-content").innerHTML+="<code>"+c+"</code><br>",$("result-content").innerHTML+="<br>Hashcat ready format:",$("result-content").innerHTML+="<code>"+c+"*"+r+"*"+o+"*"+a+"</code><br>"}function resultHandshake(e,n){$("result-content").innerHTML="";var t=document.createElement("a");t.setAttribute("href","capture.pcap"),t.text="Download PCAP file";var r=document.createElement("a");r.setAttribute("href","capture.hccapx"),r.text="Download HCCAPX file",$("result-content").innerHTML+="<p>"+t.outerHTML+"</p>",$("result-content").innerHTML+="<p>"+r.outerHTML+"</p>";var o="";for(let t=0;t<n;t+=1)o+=uint8ToHex(e[t]),t%50==49&&(o+="\n");$("result-content").innerHTML+="<pre><code>"+o+"</code></pre>"}function uint8ToHex(t){return("00"+t.toString(16)).slice(-2)}function updateConfigurableFields(t){switch($("attack_method").outerHTML=defaultAttackMethods,parseInt(t.value)){case AttackTypeEnum.ATTACK_TYPE_PASSIVE:console.log("PASSIVE configuration");break;case AttackTypeEnum.ATTACK_TYPE_HANDSHAKE:console.log("HANDSHAKE configuration"),$("attack_timeout").value=60,setAttackMethods(["DEAUTH_ROGUE_AP (PASSIVE)","DEAUTH_BROADCAST (ACTIVE)","CAPTURE_ONLY (PASSIVE)"]);break;case AttackTypeEnum.ATTACK_TYPE_PMKID:console.log("PMKID configuration"),$("attack_timeout").value=5;break;case AttackTypeEnum.ATTACK_TYPE_DOS:console.log("DOS configuration"),$("attack_timeout").value=120,setAttackMethods(["DEAUTH_ROGUE_AP (PASSIVE)","DEAUTH_BROADCAST (ACTIVE)","DEAUTH_COMBINE_ALL"]);break;default:console.log("Unknown attack type")}}function setAttackMethods(t){$("attack_method").removeAttribute("disabled"),t.forEach(function(t,e){let n=document.createElement("option");n.value=e,n.text=t,n.selected=!0,$("attack_method").appendChild(n)})}</script></body></html>